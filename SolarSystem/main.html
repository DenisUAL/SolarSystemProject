<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SolarSystem</title>
</head>
<body>
    <script type = "text/javascript" src = "point.js"></script>
    <script type = "text/javascript">

        var js = new PointJS('2d',100,100,{backgroundColor: 'black'});
        var game = js.game;
        var sys = js.system;
        sys.initFullPage();
        var cam = js.camera;
        var mouse = js.mouseControl;
        mouse.initMouseControl();
        var key = js.keyControl;
        key.initKeyControl();
        var p = js.vector.point;
        
        var scale = 1;

        var width = game.getWH().w;
        var height = game.getWH().h;

        var back = game.newImageObject({
            file: 'blackSpace.jpg'
        });

        var route = game.newPolygonObject( {
            points : [],
            pointColor : "#128500",
            strokeWidth : 0.001,
        });

        var spacing = 15;

        var info = game.newRoundRectObject({
           w: 150, h: 60,
            fillColor: '#590401',
            strokeColor: '#FFA91D',
            strokeWidth: 5,
            alpha: 0.5,
            radius: 15,
            visible: false
        });

        var infoText = game.newTextObject({
            size: 30,
            color: 'white',
            font: 'serif',
            padding: 20,
            visible: false
        })

        var sun = game.newCircleObject({
            radius: 696/2, fillColor: '#f3ff35'
        });
        sun.setUserData({name: 'Sun'});

        var mercury = game.newCircleObject({
            radius: 2.4/2, fillColor: '#ffad48'
        });
        mercury.setUserData({name: 'Mercury', orbit:(sun.radius + ((width-sun.radius)/10)), speed: 0.47});

        var venus = game.newCircleObject({
            radius: 6/2, fillColor: '#c5a35c'
        });
        venus.setUserData({name: 'Venus', orbit:(sun.radius + ((width-sun.radius)/10*2)), speed: 0.35});

        var earth = game.newCircleObject({
            radius: 6.3/2, fillColor: '#3753ff'
        });
        earth.setUserData({name: 'Earth', orbit: (sun.radius + ((width-sun.radius)/10*3)),speed: 0.29});

        var moon = game.newCircleObject({
            radius: 1.7/2, fillColor: '#fdfdff'
        });
        moon.setUserData({name: 'Moon',orbit: earth.radius + 5, speed: 0.01});

        var mars = game.newCircleObject({
            radius: 3.4/2, fillColor: '#ff530b'
        });
        mars.setUserData({name: 'Mars', orbit: (sun.radius + ((width-sun.radius)/10*3.7)), speed: 0.24});

        var jupiter = game.newCircleObject({
            radius: 71.3/2, fillColor: '#95b8ff'
        });
        jupiter.setUserData({name: 'Jupiter', orbit: (sun.radius + ((width-sun.radius)/10*5)),speed: 0.13});

        var saturn = game.newCircleObject({
            radius: 60.1/2, fillColor: '#d6c480'
        });
        saturn.setUserData({name: 'Saturn', orbit: (sun.radius + ((width-sun.radius)/10*6.5)), speed: 0.09});

        var uran = game.newCircleObject({
            radius: 26.5/2, fillColor: '#4ffaff'
        });
        uran.setUserData({name: 'Uranus', orbit: (sun.radius + ((width-sun.radius)/10*7.5)), speed: 0.06});

        var neptune = game.newCircleObject({
            radius: 24.7/2, fillColor: '#5d57ff'
        });
        neptune.setUserData({name: 'Neptune', orbit: (sun.radius + ((width-sun.radius)/10*8.5)), speed: 0.05});

        var pluton = game.newCircleObject({
            radius: 2/2, fillColor: '#aba7a8'
        });
        pluton.setUserData({name: 'Pluto', orbit: (sun.radius + ((width-sun.radius)/10*9)), speed: 0.04});

        var defaultCamPos = p(width/2,height/2);
        sun.setPositionC(defaultCamPos);

        function routeCreate(elem){
            route.points.push(elem.getPositionC());
        }

        var followMode = false;
        var currentPlanet = 0;
        var SolSysObj = [];
        SolSysObj.push(sun,mercury,venus,earth,moon,mars,jupiter,saturn,uran,neptune,pluton);
        var routeDrawDelay = 0;


        game.newLoop('solarSys', function(){
            game.clear();
            sun.setPositionC(defaultCamPos);
            var SSC = p(sun.getPosition().x + sun.radius, sun.getPosition().y + sun.radius);
                routeDrawDelay++;

            back.setPositionC(sun.getPositionC());
            info.setPosition(p(cam.getPosition().x + width - info.w - spacing, cam.getPosition().y + spacing));
            mercury.circlingC(SSC, mercury.orbit*scale, mercury.speed*scale);
            venus.circlingC(SSC, venus.orbit*scale, venus.speed*scale);
            earth.circlingC(SSC, earth.orbit*scale, earth.speed*scale);
            moon.circlingC(earth.getPositionC(), moon.orbit*scale, moon.speed*scale);
            mars.circlingC(SSC, mars.orbit*scale, mars.speed*scale);
            jupiter.circlingC(SSC, jupiter.orbit*scale, jupiter.speed*scale);
            saturn.circlingC(SSC, saturn.orbit*scale, saturn.speed*scale);
            uran.circlingC(SSC, uran.orbit*scale, uran.speed*scale);
            neptune.circlingC(SSC, neptune.orbit*scale, neptune.speed*scale);
            pluton.circlingC(SSC, pluton.orbit*scale, pluton.speed*scale);

            for(var i in fon){
                fon[i][0].draw();
            }

            //back.draw();

            //SolSysObj.forEach(routeCreate);

//            if(routeDrawDelay % 30 === 0){
//                SolSysObj.forEach(routeCreate);
//            }
//            route.draw();

            if(key.isDown( "PLUS" )){
                scale = 1;
                scale+=0.01;
                SolSysObj.forEach(function (elem) {
                    elem.orbit *= scale;
                    //elem.speed *= scale;
                    elem.radius *= scale;
                });
            }
            if(key.isDown('MINUS')){
                scale = 1;
                scale-=0.01;
                SolSysObj.forEach(function (elem) {
                    elem.orbit *= scale;
                    //elem.speed *= scale;
                    elem.radius *= scale;
                });
            }

            js.OOP.drawArr(SolSysObj);

            if(key.isPress("F")){
                followMode = !followMode;
            }

            if(key.isPress("UP") || key.isPress('RIGHT')){
                if(currentPlanet < SolSysObj.length -1)
                    currentPlanet++;
            }
            if(key.isPress("DOWN") || key.isPress('LEFT')){
                if(currentPlanet > 0)
                    currentPlanet--;
            }

            if(key.isPress("I")){
                info.visible = !(info.visible);
                infoText.visible = info.visible;
            }

            if(key.isPress("S")){
                var inc
                SolSysObj.forEach(function (elem) {
                    elem.speed *= inc;
                });
            }

            if(followMode){
                infoText.setText(SolSysObj[currentPlanet].name);
                infoText.setPosition(info.getPosition());
                info.draw();
                infoText.draw();
                cam.moveTimeC(SolSysObj[currentPlanet].getPositionC(),15);
                //SolSysObj[currentPlanet].drawStaticBox();
            }else{
                cam.moveTimeC( mouse.getPosition(), 30);
            }

        });

        game.setLoop('solarSys');
        game.start();


    </script>

</body>
</html>